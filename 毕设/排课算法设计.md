### 排课算法设计

#### 已知情况

- 排课只需要选教室，教室能否被选需要满足以下条件
    - 教室人数 $>$ 选课人数
    - 这一时刻（xx周xx日xx时段）没被选
    - 教室所拥有功能满足课程所需功能
- 需要人文关怀，重要度依次为：
    - 针对同一个老师连续的课（这一周的这一天的连续节次），应做到同一个教室
- 教室有好有坏，尽量选好的教室



#### 存在的问题

- 针对教室能否被选，在第二点中，很难判断。原因在于，课表往往是一个时间段（xx周~xx周），如何判断是否冲突呢？
- 如何满足人文关怀呢？如果需要满足人文关怀，那么意味着，对于同一老师的课，课程之间是有联系的。我们不妨对数据先排序，保证同一老师的连续课程紧挨着。
- 算法是必要的，因为排课的影响因素太多，必须设计数据结构，一来存储从表中读入的数据，二来为排课算法服务。



#### 思考结果

- 稍微总结一下，影响排课策略的因素如下：
    - 人数（教室人数 $>$ 课程人数）（必须满足条件）
    - 功能（教室功能符合课程所需功能）（必须满足条件）
    - 老师连续的课需在同一教室
    - 尽量选好的教室
- 课程连续的判断条件是什么？
    - 同一个老师
    - 同一周
    - 同一天的紧邻时段

- 由于周的信息往往是连续的，不好进行精确判断，所以有重合就算定同一周

大概的想下解法：

- 连续的课之间连条线，代表有边，那么就该：
    - 按照教师姓名排序，姓名相同按照时间排序





如果连边的话还是太复杂了，我们来思考假如只是给课程按照老师排序，能否大概满足要求：

- 教室是有评分的，往往教室的评分顺序不变，那么选定的教室大概是相同的。



我们不妨分为三步，先排序，再选满足条件的教室，最后判断是否时间冲突

- **排序**。按照老师给课程排序。

- **选教室**。选教室的含义是，对于课表的一行数据，选上满足条件的教室。
    - 可能由于之前的课选了教室，导致连续的课程可能选不到相同的教室
    - 一般这种情况都是回溯，但我们的人性化设计并不是强制要求，所以就作罢
    - 为了改善这种情况，每次排序我们将教室的排序做个相对随机。
- **判断时间冲突**。
    - 每次判断时间冲突都去执行 sql 语句的话太慢了
    - 因此我们有必要定义一个数据结构来存储时间。
    - 这个数据结构应支持以下操作：1. 查询某个教室的某一时间段是否被占用。2.将某个教室的某一时间段修改状态。
    - 具体形态还没想好，以后再说。


